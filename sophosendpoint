curl -XGET -H "Authorization: Bearer 0sImF1ZCI6ImFwaTovL2NlbnRyYWwtcHJvdmlzaW9uaW5nIiwiYXV0aF90aW1lIjoxNjQxNjgwMjI3LCJjbGllbnRfaWQiOiJjNjM3NWQyNi0yOWNjLTRkZWItYjNjOC1iMTM4MGFlYjkzZjgiLCJleHAiOjE2NDE2ODM4MjcsImdpZCI6IjA0OWJlYTRkLTU1MDQtNGMxZC1hZDFiLTM4ZGI2YTk5MWM2OSIsImp0aSI6IklELjg5NDg1MGE0LTVkYTYtNDA4Ny04NDZiLWIxMzMzNmUwMWNiMSIsImlhdCI6MTY0MTY4MDIyNywiaXNzIjoiaHR0cHM6Ly9pZC5zb3Bob3MuY29tIiwicnRfaGFzaCI6ImRJMWJFbjVYRHBOdnRJQzRTMWk1U1E9PSIsInZlciI6MX0.k2nseFkP16uqNs0WMVP7zGM-wP_aZHhBiaeX4XVtakJpFrvuOENsbYljPspbLWa1ko8rKNJO0O2CKvgaNkkJTvFPViTNO7MhzioWF_BxXB9B3n8t_uFFFZxLXtw5v4XgsH0jcEajAnxAmX4PBc94dV9moY2n3vQm_caXHadGgCEsayTF33rmWIWPPEDO3Cy0l2cT_BjEZfsgn3rXD6VaTapuzZcUqs0stm8KmRMA3TybDbu5SGy3vOB1L0yiPAELkP6UbZ38VoBIZM4d8IjchnHETvnu0kL_CnuOcxLfpZxQ_q7FrE9DLptrtyL-DKQWXiIbl8qdEwZcdlwQ7WhqCb5WL4b23_orb9Lhx8BdUN5ZpNrXW-HvCf9z-EdcDmvWvgndh4SK6EC7dBEMrBd56t7GEezhYEOgtU0aX658cH3ZfGZ_gOXXzbg2q_B2TNeFmWtyPkfhQ4vW-xbf_IVU_YpAcvC7EREwW5wFd-521sWhFMmrtRD5vlEtQZzs9ks4_UH6iSmtPHKoG3CDYl8vSv6foqtmyb3G5YuRZvzw0PgIWJPZ6K-M5Ig65xij4PgV0m6sQ1f1oyniEZPEG9z5L_3zSyce8JhBqqcF-c_751NfnRkrHUR_hUct5V_0koKF3aarVTvvF8C_yDKGa2nn1xkLzcML9NS3BWdC2YJqSiI" -H "X-Tenant-ID: 049bea4d-c1d-ad1b-38db6a991c69" https://api-us01.central.sophos.com/endpoint/v1/endpoints


#jwt token
curl -XPOST -H "Content-Type:application/x-www-form-urlencoded" -d "grant_type=client_credentials&client_id=70c2a9ea-7a59-4521-b139-7e9581&client_secret=d921ae64b2c2f05331061f09ed0e0546e8c8cfad4a90b22f6f6ee50813da9a442d40&scope=token" https://id.sophos.com/api/v2/oauth2/token

{"access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjFIaXNtSjFSZmIwRWJqYjJ6dy01LVhTNlFiYXBaZWtOcVpsVU51TVdac2cifQ.eyJhcHBfaW5mbyI6eyJhY2NvdW50VHlwZSI6ImN1c3RvbWVyIn0sImF1ZCI6ImFwaTovL2NlbnRyYWwtcHJvdmlzaW9uaW5nIiwiYXV0aF90aW1lIjoxNjQxNzUwNzk4LCJjbGllbnRfaWQiOiI3MGMyYTllYS03YTU5LTQ1MjEtYjEzOS0xOGNkMzc3ZTk1ODEiLCJleHAiOjE2NDE3NTQzOTgsImdpZCI6IjA0OWJlYTRkLTU1MDQtNGMxZC1hZDFiLTM4ZGI2YTk5MWM2OSIsImp0aSI6IklELjZhY2JhNTcxLWQ4ZDctNDBlMy1hYjRkLTJiMjc1MDM4NWMzZCIsImlhdCI6MTY0MTc1MDc5OCwiaXNzIjoiaHR0cHM6Ly9pZC5zb3Bob3MuY29tIiwicnRfaGFzaCI6IjZKekwraUhvNDFzV1ZscXNReEJaNEE9PSIsInZlciI6MX0.SYo5Ky_IehfpyY0ALXbYKfKkLmcm2oUhoIkTUqVZJWtptqdO0Q_M_z0OAVVfcmYkHcaZNzsIYlV61nX0d1FVtHw-3eukoKmOI8atB0wE1JQMPzXVtHvdT_haI43EAd28QEtDZM2A7cj_Jl0vG4i4_l1tqHCLUnIO1YqsiKCMxdwBWPBmv2A9lvoJh_Leoqnmrkguaidl3bte8RfQiuWM4CkRnMEyVuue5rIEEDIkKOm4BFXUvaTEbNjF-hKPxa6Wx92GUJY07nTcsFIaMOjTszQFgD_LpBUFZ8ShiK3-fxF7BKwTbeF_GKUL4W6AHI4yvDuGkarij6Aqzs3A5c4e2IeBbvCIzimW7WpHl5E8o5Ka10ThlkxqFZ1jrelaiK7Xyvevj-6b2WLDJQ1qRMjDILiW0Y8BN_l6D35Qu4szC1dNqXkJ3yX5Kvm5qVED6qUOxh_8XxDQdD9u6dhAuGRzRq2rbYUkQFpmU1ZJWLFxFPYI8nTv-vgCtzQs7y1jBANHcJHbYYEa3SaEFFmYGsVt_Y9r-lFu5mPieIavtnLbZmr6qwIUoSNb-5Wpxhv8kXrOYRGlCmJCOKBEr_7n0CmZct13nnf5ZFYQbS95mU43OL9djpyFm_TiQg9LMXMtOdLiwnUi0qDD7zxcr2CsI5aT2058juseaEfKPqZoJpgtb9s", "errorCode": "success", "expires_in": 3600, "message": "OK", "refresh_token": "497ae42caf1639f696435b24ec37ea1d8a37d84f2241984ef8aa440fa4720467", "token_type": "bearer", "trackingId": "c4d1c5d6-4724-49f2-9673-d6ffa5d08f92"}

#get tenant ID
curl -XGET -H "Authorization: Bearer eyJ0eXAiOiJKV1QiLiOiJSUlFiYXBaZWtOcVpsVU51TVdac2cifQ.eyJhcHBfaW5mbyI6eyJhY2NvdW50VHlwZSI6ImN1c3RvbWVyIn0sImF1ZCI6ImFwaTovL2NlbnRyYWwtcHJvdmlzaW9uaW5nIiwiYXV0aF90aW1lIjoxNjQxODM0NjIxLCJjbGllbnRfaWQiOiI3MGMyYTllYS03YTU5LTQ1MjEtYjEzOS0xOGsImdpZCI6IjA0OWJlYTRkLTU1MDQtNGMxZC1hZDFiLTM4ZGI2YTk5MWM2OSIsImp0aSI6IklELjQ4NzI4MTAyLTNkM2MtNDgzNC05MGNmLTg0ZWU3MDhhOWVjMSIsImlhdCI6MTY0MTgzNDYyMSwiaXNzIjoiaHR0cHM6Ly9pZC5zb3Bob3MuY29tIiwicnRfaGFzaCI6ImlldHpJUnhvZjdYQzFnNXErQ3NMY3c9PSIsInZlciI6MX0.hxkSt1da7CeA__ZUBy_UgQ5jIiLBH1wnGUWsFT_NqL8_Zax0O4EQODjuHe2JG6ujv5dU4OHAJ0FO-1VXvAqAjpVnXtPAGaCQ6cpE_VyuCN1c690qkf1JIkSDv2R9UvesZKOK2FQ1lww7xXrkZzB0Rd2zyrU_-A0zevAmt4ohqd0bNUWgp2rJCJ7tn1hp9a-IeLZD_2G6W0dXFaO8y6lOzWggYW2nsuOvWa8jgs4FLWZqfN9w0tDyTo7CRcvVixjws-ipBt6PRZiu2HRYSgGQb4vF2gj4LokUtZGeGoe8XQhSzVWY05UR0hQ5_wYrfBcMNXkUgg58wB6DLTOI0M883SLaBT48AKfhIcTL2whd_7XPuo8z83sC_CUL_W0JQxUljSptfj4RnixcD6vxr5JieV1WEaRjfSKxdZJZ17I45Jk5f_0QA9aSSEU0siG_ECjVB72KEmmhDENE4ndNaRmV1HEv_yzU4vPiMmndab9QhHJ-1kKZgs_5sXaxfeq8vOtZyqeTrMKpF1ZzaN0yJfEGhOGk7e0BSS4eMhVZxVOvdNX_hphblD_rHv-Ur16I4DFHiP2HqPJl9--7rU-e233AA_5nzBoL9v6bQMTlleiN3ATjodY-d1fDDNU1wmB2T6hTE7wBd2tNobB2toEJSAhy0UWs_vqRax3t9RYtaKRr-c0" https://api.central.sophos.com/whoami/v1

{"id":"049b04-4c1d-ad1b-38db6a991c69","idType":"tenant","apiHosts":{"global":"https://api.central.sophos.com","dataRegion":"https://api-eu01.central.sophos.com"}}

#List all the endpoints for a tenant

curl -XGET -H "Authorization: Bearer tyJ02XAiOiJKVfy01LVhTNlFiYXBaZWtOcVpsVU51TVdac2cifQ.eyJhcHNvdW50VHlwZSI6ImN1c3RL2NlbnRyYWwtcHJvdmlzaW9uaW5nIiwiYXV0aF90aW1lIjoxNjQxODM0NjIxLCJjbGllbnRfaWQiOiI3MGMyYTllYS03YTU5LTQ1MjEtYjEzOS0xOGNkMzc3ZTk1ODEiLCJleHAiOjE2NDE4MzgyMjEsImdpZCI6IjA0OWJlYTRkLTU1MDQtNGMxZC1hZDFiLTM4ZGI2YTk5MWM2OSIsImp0aSI6IklELjQ4NzI4MTAyLTNkM2MtNDgzNC05MGNmLTg0ZWU3MDhhOWVjMSIsImlhdCI6MTY0MTgzNDYyMSwiaXNzIjoiaHR0cHM6Bob3MYQzFnNXErQ3NMY3c9PSIsInZlciI6MX0.hxkSt1da7CeA__ZUBy_UgQ5jIiLBH1wnGUWsFT_NqL8_Zax0O4EQODjuHe2JG6ujv5dU4OHAJ0FO-1VXvAqAjpVnXtPAGaCQ6cpE_VyuCN1c690qkf1JIkSDv2R9UvesZKOK2FQ1lww7xXrkZzB0Rd2zyrU_-A0zevAmt4ohqd0bNUWgp2rJCJ7tn1hp9a-IeLZD_2G6W0dXFaO8y6lOzWggYW2nsuOvWa8jgs4FLWZqfN9w0tDyTo7CRcvVixjws-ipBt6PRZiu2HRYSgGQb4vF2gj4LokUtZGeGoe8XQhSzVWY05UR0hQ5_wYrfBcMNXkUgg58wB6DLTOI0M883SLaBT48AKfhIcTL2whd_7XPuo8z83sC_CUL_W0JQxUljSptfj4RnixcD6vxr5JieV1WEaRjfSKxdZJZ17I45Jk5f_0QA9aSSEU0siG_ECjVB72KEmmhDENE4ndNaRmV1HEv_yzU4vPiMmndab9QhHJ-1kKZgs_5sXaxfeq8vOtZyqeTrMKpF1ZzaN0yJfEGhOGk7e0BSS4eMhVZxVOvdNX_hphblD_rHv-Ur16I4DFHiP2HqPJl9--7rU-e233AA_5nzBoL9v6bQMTlleiN3ATjodY-d1fDDNU1wmB2T6hTE7wBd2tNobB2toEJSAhy0UWs_vqRax3t9RYtaKRr-c0" -H "X-Tenant-ID: 049bea-38db6a991c69" https://api-eu01.central.sophos.com/endpoint/v1/endpoints

Output:
{"items":[{"id":"34f2b8-bcf8-1776bfc7e489","type":"computer","tenant":{"id":"049be4c1d-ad1b-38db6a991c69"},"hostname":"DESKTOP-UL8LJSO","health":{"overall":"good","threats":{"status":"good"},"services":{"status":"good","serviceDetails":[{"name":"HitmanPro.Alert service","status":"running"},{"name":"Sophos Anti-Virus","status":"running"},{"name":"Sophos Anti-Virus Status Reporter","status":"running"},{"name":"Sophos AutoUpdate Service","status":"running"},{"name":"Sophos Clean Service","status":"running"},{"name":"Sophos Device Control Service","status":"running"},{"name":"Sophos Device Encryption Service","status":"running"},{"name":"Sophos Endpoint Defense","status":"running"},{"name":"Sophos Endpoint Defense Service","status":"running"},{"name":"Sophos File Scanner","status":"running"},{"name":"Sophos File Scanner Service","status":"running"},{"name":"Sophos IPS","status":"running"},{"name":"Sophos MCS Agent","status":"running"},{"name":"Sophos MCS Client","status":"running"},{"name":"Sophos Network Threat Protection","status":"running"},{"name":"Sophos Safestore Service","status":"running"},{"name":"Sophos System Protection Service","status":"running"},{"name":"Sophos Web Control Service","status":"running"},{"name":"Sophos Web Intelligence Filter Service","status":"running"},{"name":"Sophos Web Intelligence Service","status":"running"}]}},"os":{"isServer":false,"platform":"windows","name":"Windows 10 Education","majorVersion":10,"minorVersion":0,"build":19042},"ipv4Addresses":["172.16.16.193"],"macAddresses":["00:FF26:9D","08:00::3B"],"associatedPerson":{"name":"DESKTOP-UL8LJSO\\CVE","viaLogin":"DESKTOP-UL8LJSO\\CVE","id":"d8cbee95-96-e8a2dc0bd916"},"tamperProtectionEnabled":true,"assignedProducts":[{"code":"endpointProtection","version":"10.8.11.3","status":"installed"},{"code":"deviceEncryption","version":"2.1.182","status":"installed"},{"code":"interceptX","version":"2.0.24","status":"installed"},{"code":"coreAgent","version":"2.20.6","status":"installed"}],"lastSeenAt":"2022-01-09T15:06:05.523Z","encryption":{"volumes":[{"volumeId":"\\\\?\\Volume{8e912335-0000-0000-0000-300300000000}\\","status":"notEncrypted"}]}}],"pages":{"size":50,"maxSize":500}}

GET /settings/allowed-items

Get all allowed items.

curl -XGET -H "X-Tenant-ID: 0b-38db6a991c69" https://api-eu01.central.sophos.com/endpoint/v1/settings/allowed-items


#Get allowed items

curl -XGET -H "Authorization: Bearer IwRWJqYjJ6dy01LVhTNlFiYXBaZWtOcVJhY2NvdW9uaW5nIiwiYXV0aF90aW1lIjoxNjQxODM0NjIxLCJjbGllbnRfaWQiOiI3MGMyYTllYS03YTU5LTQ1MjEtYjEzOS0xOGNkMzc3ZTk1ODEiLCJleHAiOjE2NDE4MzgyMjEsImdpZCI6IjA0OWJlYTRkLTU1MDQtNGMxZC1hZDFiLTM4ZGI2YTk5MWM2OSIsImp0aSI6IklELjQ4NzI4MTAyLTNkM2MtNDgzNC05MGNmLTg0ZWU3MDhhOWVjMSIsImlhdCI6MTY0MTgzNDYyMSwiaXNzIjoiaHR0cHM6Ly9pZC5zb3Bob3MuY29tIiwicnRfaGFzaCI6ImlldHpJUnhvZjdYQzFnNXErQ3NMY3c9PSIsInZlciI6MX0.hxkSt1da7CeA__ZUBy_UgQ5jIiLBH1wnGUWsFT_NqL8_Zax0O4EQODjuHe2JG6ujv5dU4OHAJ0FO-1VXvAqAjpVnXtPAGaCQ6cpE_VyuCN1c690qkf1JIkSDv2R9UvesZKOK2FQ1lww7xXrkZzB0Rd2zyrU_-A0zevAmt4ohqd0bNUWgp2rJCJ7tn1hp9a-IeLZD_2G6W0dXFaO8y6lOzWggYW2nsuOvWa8jgs4FLWZqfN9w0tDyTo7CRcvVixjws-ipBt6PRZiu2HRYSgGQb4vF2gj4LokUtZGeGoe8XQhSzVWY05UR0hQ5_wYrfBcMNXkUgg58wB6DLTOI0M883SLaBT48AKfhIcTL2whd_7XPuo8z83sC_CUL_W0JQxUljSptfj4RnixcD6vxr5JieV1WEaRjfSKxdZJZ17I45Jk5f_0QA9aSSEU0siG_ECjVB72KEmmhDENE4ndNaRmV1HEv_yzU4vPiMmndab9QhHJ-1kKZgs_5sXaxfeq8vOtZyqeTrMKpF1ZzaN0yJfEGhOGk7e0BSS4eMhVZxVOvdNX_hphblD_rHv-Ur16I4DFHiP2HqPJl9--7rU-e233AA_5nzBoL9v6bQMTlleiN3ATjodY-d1fDDNU1wmB2T6hTE7wBd2tNobB2toEJSAhy0UWs_vqRax3t9RYtaKRr-c0" -H "X-Tenant-ID: 04d-5504-4c1d-6a991c69" https://api-eu01.central.sophos.com/endpoint/v1/settings/allowed-items


#Block an item from exoneration

https://developer.sophos.com/docs/endpoint-v1/1/routes/settings/blocked-items/post


#Final request to block an item using sha256

curl --request POST 'https://api-eu01.central.sophos.com/endpoint/v1/settings/blocked-items' --header 'X-Tenant-ID: 04904-4c1d-ad1b-38991c69' --header 'Authorization: Bearer IaXNtSjFSZmIwRWJqYjJ6dy01LVhTNlFiYXBaZWtOcVpsVU51TVdac2cifQ.eyJhcHBfaW5mbyI6eyJhY2NvdW50VHlwZSI6ImN1c3RvbWVyIn0sImF1ZCI6ImFwaTovL2NlbnRyYWwtcHJvdmlzaW9uaW5nIiwiYXV0aF90aW1lIjoxNjQxODM0NjIxLCJjbGllbnRfaWQiOiI3MGMyYTllYS03YTU5LTQ1MjEtYjEzOS0xOGNkMzc3ZTk1ODEiLCJleHAiOjE2NDE4MzgyMjEsImdpZCI6IjA0OWJlYTRkLTU1MDQtNGMxZC1hZDFiLTM4ZGI2YTk5MWM2OSIsImp0aSI6IklELjQ4NzI4MTAyLTNkM2MtNDgzNC05MGNmLTg0ZWU3MDhhOWVjMSIsImlhdCI6MTY0MTgzNDYyMSwiaXNzIjoiaHR0cHM6Ly9pZC5zb3Bob3MuY29tIiwicnRfaGFzaCI6ImlldHpJUnhvZjdYQzFnNXErQ3NMY3c9PSIsInZlciI6MX0.hxkSt1da7CeA__ZUBy_UgQ5jIiLBH1wnGUWsFT_NqL8_Zax0O4EQODjuHe2JG6ujv5dU4OHAJ0FO-1VXvAqAjpVnXtPAGaCQ6cpE_VyuCN1c690qkf1JIkSDv2R9UvesZKOK2FQ1lww7xXrkZz_-A0zevAmt4ohqd0bNUWgp2rJCJ7tn1hp9a-IeLZD_2G6W0dXFaO8y6lOzWggYW2nsuOvWa8jgs4FLWZqfN9w0tDyTo7CRcvVixjws-ipBt6PRZiu2HRYSgGQb4vF2gj4LokUtZGeGoe8XQhgg58wB6DLTOI0M883SLaBT48AKfhIcTL2whd_7XPuo8z83sC_CUL_W0JQxUljSptfj4RnixcD6vxr5JieV1WEaRjfSKxdZJZ17I45Jk5f_0QA9aSSEU0siG_ECjVB72KEmmhDENE4ndNaRmV1HEv_yzU4vPiMmndab9QhHJ-1kKZgs_5sXaxfeq8vOtZyqeTrMKpF1ZzaN0yJfEGhOGk7e0BSS4eMhVZxVOvdNX_hphblD_rHv-Ur16I4DFHiP2HqPJl9--7rU-e233AA_5nzBoL9v6bQMTlleiN3ATjodY-d1fDDNU1wmB2T6hTE7wBd2tNobB2toEJSAhy0UWs_vqRax3t9RYtaKRr-c0' --header 'Accept: application/json' --header 'Content-Type: application/json' --data '{"type":"sha256","properties":{"certificateSigner":"test","path":"/test/test","fileName":"test","sha256":"ba7816bf8f01cfea4396177a9cb410ff61f20015ad"},"comment":"test"}' --compressed
